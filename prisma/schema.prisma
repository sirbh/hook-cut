// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String    @id @default(uuid())
  // email     String    @unique
  user_id   String    @unique
  createdAt DateTime  @default(now())

  projects  Project[]
}


model Project {
  id        String   @id @default(uuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  // Raw video
  rawVideoS3Key   String?
  rawDurationSec  Int?
  rawWidth        Int?
  rawHeight       Int?


  // Processed video
  st360pS3Key      String?
  st460pS3Key      String?
  hq720pS3Key      String?

  status     ProjectStatus

  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  // captions   Caption[]
  // clips      Clip[]

  @@index([userId])
}


// model Clip {
//   id        String   @id @default(uuid())
//   projectId String
//   project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

//   startSec  Float
//   endSec    Float

//   // Preview
//   st360pS3Key  String?
//   st460pS3Key  String?
//   thumbnailS3Key   String?

//   // High quality (on demand)
//   hq720pS3Key      String?
//   hqStatus         ClipHQStatus

//   // aspectRatio      String   // "9:16", "1:1", "16:9"

//   createdAt        DateTime @default(now())

//   @@index([projectId])
// }

enum ProjectStatus {
  UPLOADED
  PREPROCESSING
  PREVIEW_READY
  READY_FOR_CLIPS
  FAILED
  NEW
}

// enum CaptionStatus {
//   PENDING
//   PROCESSING
//   COMPLETED
//   FAILED
// }

// enum ClipHQStatus {
//   NOT_REQUESTED
//   PROCESSING
//   READY
//   FAILED
// }
